<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="popup.css">
</head>
<body>
  <div id="app">
    <!-- Supported page state -->
    <div id="supported" class="hidden" role="main" aria-labelledby="supported-title">
      <div class="header">
        <img src="../icons/icon48.png" alt="" class="icon" aria-hidden="true">
        <h1 id="supported-title">Open in desktop app?</h1>
      </div>
      <p class="description">
        This will download the current <span id="doc-type">document</span> and open it locally.
      </p>
      <p class="filename" id="filename" title=""></p>
      <div class="buttons">
        <button id="cancel" class="secondary" type="button">Cancel</button>
        <button id="open" class="primary" type="button">Open</button>
      </div>
    </div>

    <!-- Unsupported page state -->
    <div id="unsupported" class="hidden" role="main" aria-labelledby="unsupported-title">
      <div class="header">
        <img src="../icons/icon48.png" alt="" class="icon" aria-hidden="true">
        <h1 id="unsupported-title">Not supported</h1>
      </div>
      <p class="description">This extension works with:</p>
      <ul class="site-list" role="list">
        <li>Google Docs</li>
        <li>Google Sheets</li>
        <li>Google Slides</li>
      </ul>
      <div class="buttons">
        <button id="close" class="secondary" type="button">Close</button>
      </div>
    </div>

    <!-- Error state -->
    <div id="error" class="hidden" role="alert" aria-labelledby="error-title">
      <div class="header">
        <img src="../icons/icon48.png" alt="" class="icon" aria-hidden="true">
        <h1 id="error-title">Error</h1>
      </div>
      <p class="description" id="error-message">Something went wrong.</p>
      <details id="error-details" class="error-details hidden">
        <summary>Technical details</summary>
        <pre id="error-details-content"></pre>
      </details>
      <div class="buttons">
        <button id="retry" class="secondary hidden" type="button">Retry</button>
        <button id="dismiss" class="secondary" type="button">Dismiss</button>
      </div>
    </div>

    <!-- V2 Extracting state -->
    <div id="extracting" class="hidden" role="status" aria-live="polite" aria-label="Extraction in progress">
      <div class="header">
        <div class="spinner" aria-hidden="true"></div>
        <h1 id="extracting-status">Extracting...</h1>
      </div>
      <p class="description" id="extracting-detail">Please wait while we process the page.</p>
    </div>

    <!-- V2 Success state -->
    <div id="success" class="hidden" role="status" aria-live="polite">
      <div class="header">
        <div class="success-checkmark" aria-hidden="true">âœ“</div>
        <h1 id="success-title">Done!</h1>
      </div>
      <p class="description" id="success-message">Your file is ready.</p>
    </div>

    <!-- Loading state -->
    <div id="loading" role="status" aria-label="Loading">
      <div class="header">
        <img src="../icons/icon48.png" alt="" class="icon" aria-hidden="true">
        <h1>Loading...</h1>
      </div>
    </div>

    <!-- V2 Extraction state -->
    <div id="extraction" class="hidden" role="main" aria-labelledby="extraction-title">
      <div class="header">
        <img src="../icons/icon48.png" alt="" class="icon" aria-hidden="true">
        <h1 id="extraction-title">Extract Content</h1>
      </div>

      <div id="tables-section" class="section hidden">
        <h3>Tables (<span id="table-count">0</span>)</h3>
        <div id="table-preview" class="preview"></div>
        <button id="extract-xlsx" class="primary" type="button">Download as Excel (.xlsx)</button>
      </div>

      <div id="text-section" class="section hidden">
        <h3>Text Content</h3>
        <div id="text-preview" class="preview"></div>
        <div class="buttons text-buttons">
          <button id="extract-docx" class="secondary" type="button">Word (.docx)</button>
          <button id="extract-txt" class="secondary" type="button">Text (.txt)</button>
        </div>
      </div>

      <div id="pdf-section" class="section">
        <h3>Page</h3>
        <button id="extract-pdf" class="secondary" type="button">Print to PDF</button>
      </div>
    </div>
  </div>
  <script src="popup.js"></script>
</body>
</html>
